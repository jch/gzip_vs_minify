var NYTD=NYTD||{};NYTD.mostPopWidget=function(){function f(){$("mostPopTabRecommendations").setStyle({display:"block"}).addClassName("selected"),$("mostPopTabMostEmailed").setStyle({display:"block"}).removeClassName("selected"),$("mostPopContentMostEmailed").setStyle({display:"none"}).removeClassName("tabContentActive"),$("mostPopContentRecommendations").setStyle({display:"block"}).addClassName("tabContentActive"),$("mostPopTabMostViewed").setStyle({display:"none"}).removeClassName("selected"),$("mostPopContentMostViewed").setStyle({display:"none"}).removeClassName("tabContentActive"),$$(".showRecommended").each(function(a){a.setStyle({display:"none"})}),NYTD.MostPop.EventLog["mostPopContentRecommendations"]!="loaded"&&h(d,"mostPopContentRecommendations"),p("nyt-recmod","1",{domain:"nytimes.com",path:"/",expires:30})}function g(a){$("mostPopTabMostViewed").setStyle({display:"block"}),$("mostPopTabMostEmailed").setStyle({display:"block"}).addClassName("selected"),$("mostPopContentMostEmailed").setStyle({display:"block"}).addClassName("tabContentActive"),$("mostPopTabRecommendations").setStyle({display:"none"}).removeClassName("selected"),$("mostPopContentRecommendations").setStyle({display:"none"}).removeClassName("tabContentActive"),$$(".showRecommended").each(function(a){a.setStyle({display:"block"})}),NYTD.MostPop.EventLog["mostPopContentMostEmailed"]!="loaded"&&h(b,"mostPopContentMostEmailed"),a!==!0&&p("nyt-recmod","0",{domain:"nytimes.com",path:"/",expires:30})}function h(a,b){new Ajax.Request(a,{method:"get",onComplete:function(a){try{var c=a.responseText.evalJSON()}catch(d){j($(b))}switch(b){case"mostPopContentRecommendations":NYTD.MostPop.loggedIn=c.uid>0;var f=c.suggestions;NYTD.MostPop.num_articles=c.num_articles||"0",NYTD.MostPop.user_displayname=c.user_displayname||"",NYTD.MostPop.user_pic_url=c.user_pic_url||e;var h=NYTD.MostPop.contentType=="Homepage"?"?src=rechp":"?src=recg";break;case"mostPopContentMostEmailed":var f=c.articles,h="?src=me&ref=general";break;case"mostPopContentMostViewed":var f=c.articles,h="?src=mv&ref=general";break;default:var f=c.articles,h="?src=mv&ref=general"}f&&f.length>0?(k(f,$(b),h),b=="mostPopContentRecommendations"&&i(),NYTD.MostPop.EventLog[b]="loaded"):b=="mostPopContentRecommendations"&&!NYTD.MostPop.autoRecOff?(g(!0),NYTD.MostPop.autoRecOff=!0):j($(b)),$$("#"+b+" .loader").invoke("remove")},onFailure:function(a){j($(b))}})}function i(){$("recommendedFooter")&&$("recommendedFooter").setStyle({display:"block"}),NYTD.MostPop.loggedIn?($("mostPopContentRecommendations").insert({top:'<div id="recommendedHeader" class="opposingFloatControl wrap" style="display: none;">        <div class="element1"><span id="articlesPastMonth">'+NYTD.MostPop.num_articles+'</span> articles in the past month</div>        <div class="element2"><p><img class="runaroundRight user_pic" src="'+NYTD.MostPop.user_pic_url+'" /><strong>'+NYTD.MostPop.user_displayname.truncate(25)+'</strong><br /><a href="http://www.nytimes.com/recommendations">All Recommendations</a></p></div></div>'}),$("recommendedHeader")&&$("recommendedHeader").setStyle({display:"block"}),$$("#recommendedFooter .loggedIn").invoke("setStyle",{display:"block"}),$$("#recommendedFooter .loggedOut").invoke("setStyle",{display:"none"})):($("recommendedHeader")&&$("recommendedHeader").remove(),$$("#recommendedFooter .loggedIn").invoke("setStyle",{display:"none"}),$$("#recommendedFooter .loggedOut").invoke("setStyle",{display:"block"}))}function j(a){a==$("mostPopContentRecommendations")?(errorHTML='<div class="errorMessage"><p><b>We don&rsquo;t have any personalized recommendations for you at this time. Please try again later.</b></p></div>',a.childElements().each(function(a){a.setStyle({display:"none"})}),$("recommendedFooter")&&$("recommendedFooter").setStyle({display:"block"}),NYTD.MostPop.loggedIn?$$("#recommendedFooter .general").invoke("setStyle",{display:"block"}):$$("#recommendedFooter .loggedOut").invoke("setStyle",{display:"block"})):errorHTML='<div class="errorMessage"><p><b>This article list is not currently available. Please try again later.</b></p></div>',a.select(".loader").invoke("remove"),a.select(".errorMessage").invoke("remove"),a.insert({top:errorHTML})}function k(b,c,d){var e='<table class="leftAlignedMostPop"><tbody>',f="",g;for(var h=0,i=b.length;h<i;h++){if(h>=a)break;if(NYTD.MostPop.contentType!=="Homepage")if(b[h].thumbnail!=null)var f='<td class="mostPopularImg"><a title="Click to go to this article" href="'+b[h].url+d+'"><img src="'+b[h].thumbnail.url+'"></a></td>';else var f="<td></td>";b[h].kicker!=null?b[h].kicker==="Op-Ed Columnist"?g=b[h].byline.substr(3):g=b[h].kicker:g="",e+="<tr>"+f+'<td class="listNumber">'+(h+1)+'.</td><td class="mostPopularTitle"><h6 class="kicker">'+g+'</h6><h4><a title="Click to go to this article" href="'+b[h].url+d+'">'+b[h].title+"</a></h4></td></tr>\n"}e+="</tbody></table>";var j=c.select("table.leftAlignedMostPop"),k=j.length;!k||j[0].remove();var l=c.select(".errorMessage"),m=l.length;!m||l[0].remove(),c.insert({top:e})}function m(a){var b=document.createElement("style");b.setAttribute("type","text/css"),b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a)),$$("head")[0].appendChild(b)}function p(a,b,c){var d=[escape(a)+"="+escape(b)];if(c){if(c.expires){var e=new Date;e.setTime(e.getTime()+c.expires*24*60*60*1e3),d.push("expires="+e.toGMTString())}c.path&&d.push("path="+c.path),c.domain&&d.push("domain="+c.domain),c.secure&&d.push("secure")}document.cookie=d.join("; ")}function q(a){return(new RegExp(a+"=([^;]+)")).test(unescape(document.cookie))?RegExp.$1:null}var a=10;NYTD.MostPop={};var b="/recommendations/svc/mostpopular.json",c="/recommendations/svc/mostpopular.json?type=mostviewed",d="/recommendations/svc/personalized.json",e=NYTD.Hosts.imageHost+"/images/apps/timespeople/none.png";NYTD.MostPop.CG=$$("meta[name=CG]")[0].content,NYTD.MostPop.PST=$$("meta[name=PST]")[0].content,NYTD.MostPop.CG=="Homepage"?(NYTD.MostPop.contentType="Homepage",b+="?hp=1",c+="&hp=1",d+="?hp=1"):NYTD.MostPop.CG=="opinion"?NYTD.MostPop.contentType="Opinion":NYTD.MostPop.CG=="Member Center"&&NYTD.MostPop.PST=="Error Page"&&(NYTD.MostPop.contentType="Error Page"),NYTD.MostPop.EventLog={mostPopContentRecommendations:"unloaded",mostPopContentMostEmailed:"unloaded",mostPopContentMostViewed:"unloaded"};var l='#mostPopWidget.doubleRule { background:url("'+NYTD.Hosts.imageHost+'/images/global/borders/aColumnHorizontalBorder.gif") repeat-x scroll 0 16px transparent !important; border-width:0 !important; clear:both; height:auto !important; margin-bottom:0 !important; }      #mostPopWidget .kicker{ margin:0; font-size:10px !important; font-family: arial, helvetica, sans-serif; font-weight:normal; text-transform:uppercase;}     #mostPopWidget h4{ font-weight: bold }     #mostPopWidget ol{display:none;}     #mostPopWidget #tabsContainer{position:static; bottom:0; left:0 !important}     #mostPopWidget .tabs{padding:0 0 0 6px !important;text-transform:uppercase; margin-bottom: -1px; }     #mostPopWidget .tabs li{ width:150px;border-top-width:0 !important;border-right-width:0 !important;border-bottom-width:0 !important;border-left-width:0 !important;background:none;text-align:center;height:24px !important;line-height:2.25em;margin:0 -2px 0 0 !important;padding-top:13px !important ;font-weight:bold;}     #mostPopWidget .tabs li.selected{ background:url("'+NYTD.Hosts.imageHost+'/images/recommendations/plainTab160Tall.gif") no-repeat scroll center bottom !important;border-right:0 none !important;margin:0 0 0 0 !important;height:23px !important;}     #mostPopWidget .tabContent{ padding:4px 0 0 0;border:0;border-top:1px solid #cacaca;}     #mostPopWidget .tabContent .loader {text-align: center; padding:40px 0; }     #mostPopWidget .tabContent .loader img { width:18px; height: 18px; }     #mostPopWidget .tabContent table{border-collapse:collapse; width:100%; }     #mostPopWidget .tabContent table td{text-align:left !important; font-size:13px !important; height:35px; vertical-align:top; padding:6px 0 4px 0; border-bottom:1px solid #E2E2E2;}     #mostPopWidget .tabContent table tr.last td{border-bottom:0px;}     #mostPopWidget .tabContent table td.listNumber{padding:6px 10px 4px 3px;font-size:1.3em; text-align:right !important}     #mostPopWidget .tabContent table td.mostPopularImg{width:30px; padding: 4px 6px 4px 0; }     #mostPopWidget .tabContent table td.mostPopularTitle{padding-top:7px;}     #mostPopWidget .tabContent table.leftAlignedMostPop td.mostPopularImg{ padding-right:6px; }     #mostPopWidget .tabContent table.rightAlignedMostPop td.mostPopularImg{ padding-right:0px; padding-left:6px; }     #mostPopWidget .tabContent td.mostPopularImg img{ width:48px;}     #mostPopWidget .tabContent h4{ font-weight:normal; text-align:left !important; text-transform:none !important; font-size:13px !important;line-height:1.15em !important;margin-bottom:3px !important;font-family:georgia,"times new roman",times,serif !important;}    #mostPopWidget .mostFooter {  font-family: arial, helvetica, sans-serif; margin:8px 0 0 0;}    #mostPopWidget .mostFooter p {font-size: 11px;}     #articlesPastMonth { font-size: 34px; margin-right: 9px; float:left; line-height:30px}    #recommendedHeader {border-bottom: 1px solid #E2E2E2; font-size: 1.2em; font-family: arial, helvetica, sans-serif; padding:7px 2px 7px 10px}    #recommendedHeader .element1{ width: 140px  }    #recommendedHeader .element2{ width: 180px  }    #recommendedHeader .element2 img{ height:25px;  }    #recommendedHeader .element2 p{ font-size: 12px; text-align: right  }    #recommendedHeader .element2 a{ white-space: nowrap;  }    #recommendedFooter {font-family: arial, helvetica, sans-serif;}    #recommendedFooter .element1  {margin:13px 0 0 0}    #recommendedFooter p  { font-size: 1.1em}    #recommendedFooter .loggedIn span,    #recommendedFooterActions .element2 span{ font-size:10px; color:#999; }     #recommendedFooter .loggedIn span a,    #recommendedFooterActions .element2 span a{color:#666; text-decoration:underline }     #recommendedFooterActions .horizontalMenu li {padding:0 6px 0 0}    #recommendedFooterActions .element1 {margin: -1px 0 0 0}    #recommendedFooterActions { margin: 12px 0 0 0; }    #recommendedAdContainer { text-align:center}    #recommendedAdContainer iframe { border:0; }    #recommendedAdContainer span {font-size:7px; text-transform: uppercase; color:#999;}    .hideRecommended:hover,    .showRecommended:hover,    #fbLoginButton:hover {cursor: pointer}    #mostPopWidget .tabContent .errorMessage { padding:30px 20px; color: #999; font-family: arial, helvetica, sans-serif; border-bottom: 1px solid #E2E2E2; }    #mostPopWidget .tabContent .errorMessage p{ font-size:11px;  }         ';NYTD.MostPop.contentType=="Homepage"&&(l+="       #home #mostPopWidget .tabContent table td{ border-bottom: 0 !important; height: auto; padding-bottom: 2px;}       #home #mostPopWidget .tabContent table td.mostPopularTitle h4 { font-weight: bold !important; font-size: 12px !important; }      #home #mostPopWidget .tabContent table { margin: 4px 0 6px; }      #home #recommendedFooter { border-top: 1px solid #E2E2E2 !important; }      #home #mostPopWidget .mostFooter { margin:0; padding-top: 8px; border-top: 1px solid #E2E2E2 !important; }      #home #recommendedHeader { margin-bottom: 2px }      #home #mostPopWidget .tabContent .errorMessage { border-bottom: none;  }       "),NYTD.MostPop.contentType=="Opinion"&&(l+="#mostPopWidget .tabs li.selected {       background: #F4F4F4 !important;       border-top:1px solid #ccc !important;       border-left:1px solid #ccc !important;       border-right:1px solid #ccc !important;       height:23px !important;       margin:0 !important;       }       #mostPopWidget .tabs li {       background: none !important;       border:0 none !important;       height:23px !important;       margin:0 !important;       }"),NYTD.MostPop.contentType=="Error Page"&&(l+="#mostPopWidget #tabsContainer {          display: none;          padding-top: 0;        }        #mostPopWidget.doubleRule {        background: none !important;        padding-top: 0;        }        #mostPopWidget .tabContent {        border: 0 !important;        padding-top: 0;        }        #mostPopWidget .tabContent h4 {          font-family: arial,helvetica,sans-serif !important;          font-size: 14px !important;        }        #mostPopWidget .tabContent table td.mostPopularTitle {            padding-top: 6px;        }        #mostPopWidget .tabContent table td {            border-bottom: 0;            font-size: 14px !important;        }        #mostPopWidget .tabContent table td.listNumber {            font-weight: bold;            width: 20px;        }        #mostPopWidget .showRecommended {          display: none !important;        }        #mostPopWidget .tabContent table.leftAlignedMostPop td.mostPopularImg {          padding: 6px 6px 6px 0;        }        "),m(l);var n='<!-- MOST POPULAR MODULE STARTS -->             <div id="tabsContainer">             <ul class="tabs">                <li id="mostPopTabMostEmailed" class="tab" style="display: none;"><a href="http://www.nytimes.com/gst/mostpopular.html">MOST E-MAILED</a></li>                <li id="mostPopTabMostViewed" class="tab" style="display: none;"><a href="http://www.nytimes.com/gst/mostpopular.html">MOST VIEWED</a></li>                <li id="mostPopTabRecommendations" class="tab" style="display: none;"><a href="http://www.nytimes.com/recommendations">RECOMMENDED FOR YOU</a></li>             </ul>             </div>                        <div id="mostPopContentMostEmailed" class="tabContent" style="display: none;">              <div class="loader"><img src="'+NYTD.Hosts.imageHost+'/images/loaders/loading-grey-lines-circle-18.gif" /></div>              <div class="mostFooter opposingFloatControl wrap"><p class="element1"><a href="http://www.nytimes.com/gst/mostpopular.html">Go to Complete List &raquo;</a></p>              <p class="element2"><a class="showRecommended">Show My Recommendations</a></p></div>            </div>                        <div id="mostPopContentMostViewed" class="tabContent" style="display: none;">              <div class="loader"><img src="'+NYTD.Hosts.imageHost+'/images/loaders/loading-grey-lines-circle-18.gif" /></div>              <div class="mostFooter opposingFloatControl wrap"><p class="element1"><a href="http://www.nytimes.com/gst/mostpopular.html">Go to Complete List &raquo;</a></p>              <p class="element2"><a class="showRecommended">Show My Recommendations</a></p></div>            </div>                        <div id="mostPopContentRecommendations" class="tabContent" style="display: none;">              <div class="loader"><img src="'+NYTD.Hosts.imageHost+'/images/loaders/loading-grey-lines-circle-18.gif" /></div>                            <div id="recommendedFooter">                <div class="opposingFloatControl wrap">                   <p class="element1 loggedOut" style="display: none;">Log in to discover more articles<br />                  based on what you&lsquo;ve read.</p>                                    <p class="element1 loggedIn" style="display: none;"><a href="http://www.nytimes.com/recommendations">Go to Your Recommendations &raquo;</a><br />                  <span><a href="http://www.nytimes.com/content/help/extras/recommendations/recommendations.html">What&rsquo;s This?</a> | <a class="hideRecommended">Don&rsquo;t Show</a></span></p>                                    <p class="element1 general" style="display: none;"><a href="http://www.nytimes.com/content/help/extras/recommendations/recommendations.html">What&rsquo;s This?</a> | <a class="hideRecommended">Don&rsquo;t Show</a></p>                  <div id="recommendedAdContainer" class="element2">                    <span id="presentedBy">PRESENTED BY</span>                    <div id="recommendedAd">                      <iframe scrolling="no" frameborder="0" src="http://www.nytimes.com/packages/html/recommendations/ad.html" width="168" height="28"></iframe>                     </div>                  </div>                </div>                                <div id="recommendedFooterActions" class="opposingFloatControl wrap loggedOut" style="display: none;">                  <div class="element1">                    <ul class="flush horizontalMenu">                      <li><a href="/login"><img src="'+NYTD.Hosts.imageHost+'/images/recommendations/recommendedLogin.png" /></a></li>                      <li><a href="/regi"><img src="'+NYTD.Hosts.imageHost+'/images/recommendations/recommendedRegister.png" /></a>                      <li><a id="fbLoginButton"><img src="'+NYTD.Hosts.imageHost+'/images/recommendations/recommendedFacebook.png" /></a></li>                    </ul>                  </div>                  <div class="element2">                    <span><a href="http://www.nytimes.com/content/help/extras/recommendations/recommendations.html">What&rsquo;s This?</a> | <a class="hideRecommended">Don&rsquo;t Show</a></span>                  </div>                </div>              </div>                          </div>                <!-- MOST POPULAR MODULE ENDS -->',o=function(){function a(a){var c=b;NYTD.MostPop.EventLog["mostPopContentMostEmailed"]!="loaded"&&h(c,"mostPopContentMostEmailed")}function e(a){var b=c;NYTD.MostPop.EventLog["mostPopContentMostViewed"]!="loaded"&&h(b,"mostPopContentMostViewed")}function i(a){var b=d;NYTD.MostPop.EventLog["mostPopContentRecommendations"]!="loaded"&&h(b,"mostPopContentRecommendations")}$("mostPopWidget").insert(n),$("mostPopTabMostEmailed").observe("click",a),$("mostPopTabMostViewed").observe("click",e),$("mostPopTabRecommendations").observe("click",i),$$(".hideRecommended").each(function(a){a.observe("click",g)}),$$(".showRecommended").each(function(a){a.observe("click",f)}),$("fbLoginButton").observe("click",function(){NYTD.Facebook.User.login(function(){NYTD.MostPop.EventLog.mostPopContentRecommendations="unloaded";var a=d;window.setTimeout(function(){h(a,"mostPopContentRecommendations")},1e3)})}),NYTD.MostPop.recCookie=q("nyt-recmod"),NYTD.MostPop.contentType=="Error Page"||NYTD.MostPop.recCookie!=null&&NYTD.MostPop.recCookie!=1?(NYTD.MostPop.autoRecOff=!0,g()):f(),new Accordian("mostPopWidget")}()}();
